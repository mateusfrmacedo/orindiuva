<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="description" content="Acompanhe Orindiúva ao vivo.">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=VT323&family=Inter:wght@300;400;600;800&family=Share+Tech+Mono&family=Silkscreen&display=swap" rel="stylesheet">
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<meta property="og:type" content="website">
<meta property="og:title" content="Orindiúva Ao Vivo">
<meta property="og:description" content="Clima em tempo real, notícias e câmera ao vivo.">
<meta property="og:image" content=""> 

<meta name="theme-color" content="#f2f2f7" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚡</text></svg>">

<title>Orindiúva Ao Vivo</title>

<style>
:root {
  --sf: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --retro-font: 'Silkscreen', cursive;
  
  --bg-body: #f2f2f7; --text-color: #1c1c1e;
  --card-bg: #ffffff; --card-border: rgba(0,0,0,0.05); --card-shadow: 0 4px 20px rgba(0,0,0,0.08);
  --pill-bg: #f5f5f7; 
  
  /* Glass Effect */
  --glass-bg: rgba(255, 255, 255, 0.65);
  --glass-border: rgba(255, 255, 255, 0.4);
  --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
  
  /* Cores Console */
  --console-body: #2b2b2b;
  --console-texture: repeating-linear-gradient(45deg, rgba(0,0,0,0.05) 0px, rgba(0,0,0,0.05) 2px, transparent 2px, transparent 4px);
  --screen-bg: #0f380f; --screen-on: #8bac0f; --screen-pixel: #0f380f;
}

body.dark {
  --bg-body: #121212; --text-color: #ffffff;
  --card-bg: #1c1c1e; --card-border: rgba(255,255,255,0.1); --card-shadow: 0 4px 20px rgba(0,0,0,0.7);
  --pill-bg: rgba(255,255,255,0.05);
  
  /* Glass Dark */
  --glass-bg: rgba(28, 28, 30, 0.65);
  --glass-border: rgba(255, 255, 255, 0.1);
  --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
  
  --console-body: #1a1a1a;
  --screen-bg: #051405; --screen-on: #2b3805; --screen-pixel: #ccffcc;
}

* { box-sizing: border-box; }
body { margin: 0; padding: 0; height: 100%; font-family: var(--sf); background-color: var(--bg-body); color: var(--text-color); overflow-x: hidden; transition: 0.3s; }

/* LAYOUT */
.site { max-width: 1000px; margin: 0 auto; padding: 40px 24px; min-height: 100vh; display: flex; flex-direction: column; }
.header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px; }

/* SELETOR DE CIDADE */
.title-box { display: flex; align-items: center; gap: 10px; cursor: pointer; transition: opacity 0.2s; }
.title-box:hover { opacity: 0.7; }
.city-search-icon { width: 24px; height: 24px; color: #007AFF; }
.title-box h1 { margin: 0; font-size: clamp(28px, 5vw, 42px); font-weight: 800; letter-spacing: -1px; line-height: 1.1; }

/* HEADER CONTROLS */
.header-controls { display: flex; gap: 12px; }

/* MODAL */
.city-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
.city-modal-overlay.active { display: flex; }
.city-modal { background: var(--card-bg); width: 90%; max-width: 400px; padding: 24px; border-radius: 24px; border: 1px solid var(--card-border); box-shadow: 0 20px 60px rgba(0,0,0,0.5); display: flex; flex-direction: column; gap: 15px; }
.modal-input { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--card-border); background: var(--pill-bg); color: var(--text-color); font-size: 16px; outline: none; }
.modal-btn-geo { background: #007AFF; color: #fff; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
.geo-icon { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2; }
.modal-results { max-height: 200px; overflow-y: auto; display: flex; flex-direction: column; gap: 5px; }
.search-item { padding: 12px; background: var(--pill-bg); border-radius: 8px; cursor: pointer; font-size: 14px; border: 1px solid transparent; transition: 0.2s; }
.search-item:hover { background: #007AFF; color: #fff; border-color: #005bb5; }
.modal-close { background: transparent; border: none; color: #ff3b30; font-weight: bold; cursor: pointer; margin-top: 10px; }

/* Video & Dashboard */
.video-container { position: relative; width: 100%; border-radius: 30px; overflow: hidden; box-shadow: var(--card-shadow); aspect-ratio: 16/9; background: #000; border: 1px solid var(--card-border); margin-bottom: 24px; transition: all 0.5s ease; }
.video-container.hidden { display: none; } 
.video-container iframe { width: 100%; height: 100%; border: 0; }
.dashboard-card { background: var(--card-bg); border: 1px solid var(--card-border); box-shadow: var(--card-shadow); border-radius: 30px; padding: 30px; margin-bottom: 24px; display: flex; flex-direction: column; gap: 24px; }

/* Theme Toggle */
.theme-toggle { width: 44px; height: 44px; border-radius: 50%; border: 1px solid var(--card-border); cursor: pointer; background: var(--card-bg); box-shadow: var(--card-shadow); display: flex; align-items: center; justify-content: center; transition: 0.3s; color: var(--text-color); }
.theme-icon { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

/* --- PAINEL ÚNICO (LIQUID GLASS) - SIMPLIFICADO --- */
.simple-display-panel {
    display: flex;
    justify-content: center; /* Centralizado */
    align-items: center;
    width: 100%;
    margin-bottom: 0px;
    padding: 25px 30px;
    border-radius: 30px;
    
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
    
    transition: all 0.3s ease;
}

/* Lado Esquerdo: Temperatura */
.sim-left {
    display: flex;
    flex-direction: column;
    align-items: center; /* Alinhado ao centro */
    text-align: center;
}
.sim-main-temp {
    /* FONTE MENOR E RESPONSIVA */
    font-size: clamp(36px, 10vw, 60px); 
    font-weight: 300; 
    line-height: 1;
    letter-spacing: -2px;
    color: var(--text-color);
}
.sim-max-min-box {
    display: flex;
    gap: 10px;
    margin-top: 8px;
    background: rgba(128, 128, 128, 0.15);
    padding: 6px 12px;
    border-radius: 20px;
}
.sim-sub-val {
    font-size: 13px;
    font-weight: 600;
    opacity: 0.8;
}

/* --- ORINDI-CYBERDECK (GAMEBOY - INICIALMENTE OCULTO) --- */
.retro-console {
  background-color: var(--console-body); 
  background-image: var(--console-texture);
  padding: 20px; border-radius: 15px;
  box-shadow: 0 15px 30px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1);
  border: 1px solid #000;
  display: flex; flex-wrap: wrap; align-items: stretch; gap: 20px; position: relative;
  overflow: hidden;
  /* Oculto por padrão */
  display: none; 
}
.retro-console.active { display: flex; }

.caution-stripe {
  position: absolute; top: 20px; right: -30px; width: 100px; height: 20px;
  background: repeating-linear-gradient(45deg, #e6b800, #e6b800 10px, #000 10px, #000 20px);
  transform: rotate(45deg); opacity: 0.6; pointer-events: none; border: 1px solid #000;
}
.screw { width: 8px; height: 8px; background: #111; border-radius: 50%; position: absolute; box-shadow: inset 1px 1px 2px rgba(255,255,255,0.1); }
.screw.tl { top: 10px; left: 10px; } .screw.tr { top: 10px; right: 10px; }
.screw.bl { bottom: 10px; left: 10px; } .screw.br { bottom: 10px; right: 10px; }

/* TELA */
.gb-bezel { 
  background: #111; border-radius: 8px; padding: 30px 15px 15px 15px;
  box-shadow: inset 0 0 20px #000; flex: 2; min-width: 260px; position: relative;
  border: 2px solid #444;
}

.gb-screen { 
  background-color: var(--screen-bg); 
  height: 160px; border-radius: 4px; position: relative; overflow: hidden; 
  display: flex; justify-content: center; align-items: center; 
  font-family: var(--retro-font); color: var(--screen-pixel); 
  transition: background-color 0.2s;
}
/* Estilo LIGADO */
.gb-screen.on { background-color: var(--screen-on); box-shadow: inset 0 0 20px rgba(0,0,0,0.2); }
.gb-screen.on::after { content: " "; position: absolute; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%); background-size: 100% 4px; pointer-events: none; z-index: 10; }

/* Estilo DESLIGADO (Preto) */
.gb-screen:not(.on) {
    background-color: #080a08;
    box-shadow: inset 0 0 20px #000;
}
.gb-screen:not(.on) * {
    opacity: 0;
    transition: opacity 0.1s;
}

@keyframes tvOff { 0% { transform: scale(1, 1); filter: brightness(1); } 40% { transform: scale(1, 0.01); filter: brightness(5); } 80% { transform: scale(0.01, 0.01); } 100% { transform: scale(0, 0); opacity: 0; } }
.gb-screen.off-anim > * { animation: tvOff 0.4s forwards; }
@keyframes tvOn { 0% { transform: scale(0, 0); opacity: 0; } 20% { transform: scale(0.01, 0.01); opacity: 1; } 60% { transform: scale(1, 0.01); filter: brightness(5); } 100% { transform: scale(1, 1); filter: brightness(1); } }
.gb-screen.on-anim > * { animation: tvOn 0.4s forwards; }

/* STATUS BAR (Direita) */
.status-bar {
  position: absolute; top: 6px; right: 8px; z-index: 15;
  display: flex; gap: 8px; align-items: center; opacity: 0.8;
}
.status-icon { width: 14px; height: 14px; fill: var(--screen-pixel); }
.anim-pulse { animation: statusPulse 2s infinite; }
.anim-wifi { animation: statusWifi 3s infinite; }
.anim-charge { animation: statusCharge 5s infinite; }
@keyframes statusPulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
@keyframes statusWifi { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
@keyframes statusCharge { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

/* STATUS BAR LEFT (Relógio/Data) */
.status-left {
  position: absolute; top: 8px; left: 10px; z-index: 15;
  display: flex; gap: 8px; align-items: center;
  font-family: var(--retro-font);
  color: var(--screen-pixel);
  font-size: 11px;
  opacity: 0.9;
  letter-spacing: 0.5px;
}
.retro-date { font-weight: 400; }
.retro-clock { font-weight: 400; }

/* TELAS INTERNAS */
.screen-mode { display: none; width: 100%; height: 100%; flex-direction: column; align-items: center; justify-content: center; position: relative; }
.gb-screen.on .active-mode { display: flex; }

/* MODO PET */
.pet-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; }
.pet-face { font-size: 65px; line-height: 1; white-space: nowrap; margin-bottom: 0px; transition: transform 0.2s; }

/* ÁREA DE TEXTO DO PET */
.pet-text-area {
    font-family: var(--retro-font);
    font-size: 15px;
    color: var(--screen-pixel);
    text-transform: uppercase;
    text-align: center;
    min-height: 40px;
    width: 90%;
    margin-top: 15px;
    line-height: 1.2;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    display: flex;
    align-items: center;
    justify-content: center;
}
.pet-text-area.visible { opacity: 1; }

.pet-zzz { position: absolute; top: -15px; right: -25px; font-size: 24px; font-weight: bold; animation: zzz 2s infinite; display: none; }

/* MODO TEMPO */
.weather-main { 
  display: flex; flex-direction: column; align-items: center; justify-content: center; 
  width: 100%; height: 100%; position: relative; z-index: 2;
  text-align: center;
}
.wm-icon { 
  width: 42px; height: 42px; margin-bottom: 2px; 
  animation: floatIcon 3s ease-in-out infinite; 
}
.wm-icon svg { fill: var(--screen-pixel); width: 100%; height: 100%; }
.wm-temp { 
  font-size: 52px; font-weight: bold; line-height: 1; 
  margin: 0; z-index: 2; letter-spacing: -2px;
}
.wm-cond { font-size: 14px; text-transform: uppercase; margin-top: 2px; }
.wm-city { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7; margin-top: 5px; }
@keyframes floatIcon { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }

/* CONTROLES */
.console-controls {
  flex: 1; display: flex; flex-direction: column; gap: 10px;
  align-items: center; justify-content: center; min-width: 120px;
}

.power-group { display: flex; flex-direction: column; align-items: center; gap: 8px; position: relative; }
.power-led {
  width: 10px; height: 10px; border-radius: 50%;
  background: #500; border: 1px solid #000;
  box-shadow: inset 2px 2px 4px rgba(0,0,0,0.5);
  transition: 0.3s; margin-bottom: 2px;
}
.power-led::after { content:''; position:absolute; top:2px; left:2px; width:3px; height:3px; background:#fff; border-radius:50%; opacity:0.5; }
.power-led.on { background: #00ff41; box-shadow: 0 0 8px #00ff41; animation: blinkGreen 2s infinite alternate; }
.power-led.off { background: #ff0000; box-shadow: 0 0 5px #ff0000; }
@keyframes blinkGreen { from { opacity: 0.4; } to { opacity: 1; } }

.power-btn {
  width: 60px; height: 30px; background: #111; border-radius: 15px;
  border: 1px solid #444; position: relative; cursor: pointer;
}
.power-switch {
  width: 26px; height: 26px; background: #888; border-radius: 50%;
  position: absolute; top: 1px; left: 2px; transition: 0.2s;
  box-shadow: inset 1px 1px 2px #fff, 2px 2px 5px #000;
}
.power-btn.active .power-switch { left: 30px; background: #ccc; }
.label-text { font-size: 10px; color: #888; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; font-family: var(--sf); }

.action-buttons { display: flex; gap: 15px; align-items: flex-end; }
.control-unit { display: flex; flex-direction: column; align-items: center; gap: 5px; }

.analog-btn {
  width: 40px; height: 40px; border-radius: 50%;
  border: none; cursor: pointer; transition: 0.05s; position: relative;
  box-shadow: 0 5px 0 rgba(0,0,0,0.5), 0 5px 10px rgba(0,0,0,0.3), inset 0 2px 3px rgba(255,255,255,0.2);
}
.analog-btn:active { transform: translateY(4px); box-shadow: 0 1px 0 rgba(0,0,0,0.5), inset 0 2px 3px rgba(0,0,0,0.4); }
.btn-red { background: #d93f3f; }
.btn-blue { background: #3f7ad9; }

.speaker { display: grid; grid-template-columns: repeat(6, 1fr); gap: 4px; margin-top: 10px; }
.speaker-hole { width: 4px; height: 4px; background: #000; border-radius: 50%; box-shadow: inset 1px 1px 1px rgba(255,255,255,0.1); }

/* --- LETREIRO INTEGRADO --- */
.console-ticker-area { width: 100%; border-top: 2px solid #000; padding-top: 5px; }
.ticker-bezel { background: #111; padding: 6px 4px; border-radius: 4px; border: 2px solid #444; box-shadow: inset 0 0 10px #000; }

/* TELA DO TICKER */
.ticker-screen { 
    background-color: var(--screen-bg); 
    color: var(--screen-on);
    height: 26px; overflow: hidden; display: flex; align-items: center; border-radius: 2px; 
    box-shadow: inset 0 0 5px rgba(0,0,0,0.5); 
    transition: background-color 0.2s, color 0.2s;
}

/* ESTADO DESLIGADO DO TICKER */
.ticker-screen.off {
    background-color: #080a08 !important;
    box-shadow: inset 0 0 10px #000 !important;
}
.ticker-screen.off .ticker-wrap { opacity: 0; transition: opacity 0.2s; }

.ticker-wrap { width: 100%; white-space: nowrap; transition: opacity 0.5s; }
.ticker-item { 
  padding: 0 30px; 
  font-family: var(--retro-font); 
  font-size: 14px; 
  text-transform: uppercase; 
  letter-spacing: 2px; 
  /* ESTILO DIGITAL GLOSS/GLOW */
  color: #ccffcc; 
  text-shadow: 0 0 4px #00ff41, 0 0 10px #00ff41;
}
@keyframes ticker-scroll { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }
.ticker { display: inline-block; white-space: nowrap; padding-left: 100%; }

/* Animações */
@keyframes zzz { 0% { transform: translate(0,0) scale(0.5); opacity: 0; } 50% { opacity: 1; } 100% { transform: translate(10px,-15px) scale(1.2); opacity: 0; } }
@keyframes shake { 0% { transform: translate(0,0); } 25% { transform: translate(-2px,0); } 75% { transform: translate(2px,0); } }

/* Animações SEM CORES ESPECIFICAS */
.anim-angry { animation: shake 0.2s infinite; }
.anim-bounce { animation: bounce 0.6s infinite; }
.anim-shiver { animation: shiver 0.2s infinite; }
@keyframes shiver { 0% { transform: translate(1px, 1px); } 100% { transform: translate(-1px, -1px); } }
.anim-melt { animation: melt 2s infinite alternate; }
@keyframes melt { from { transform: scaleY(1); } to { transform: scaleY(0.9) translateY(2px); } }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } }

/* Resto do Site */
.modern-data-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.detail-pill { flex: 1; background: var(--pill-bg); border: 1px solid var(--card-border); padding: 20px 16px; border-radius: 18px; text-align: center; font-size: 15px; font-weight: 600; display: flex; flex-direction: column; align-items: center; gap: 8px; }
.detail-label { font-size: 11px; opacity: 0.6; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
.detail-value { font-size: 24px; font-weight: 800; color: var(--text-color); }

.forecast-row { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px; border-top: 1px solid var(--card-border); padding-top: 24px; margin-top: 8px; scrollbar-width: none; }
.forecast-row::-webkit-scrollbar { display: none; }
.forecast-item { text-align: center; display: flex; flex-direction: column; align-items: center; min-width: 60px; flex: 1; }
.f-day { font-size: 14px; font-weight: 700; opacity: 0.9; margin-bottom: 4px; text-transform: uppercase; }
.f-icon { width: 28px; height: 28px; margin-bottom: 4px; color: var(--text-color); }
.f-temp { font-size: 18px; font-weight: 700; }
.f-min { font-size: 14px; opacity: 0.7; margin-left: 6px; }

/* Print Styles */
#shareCapture { position: fixed; left: -9999px; top: 0; width: 1080px; height: 1920px; box-sizing: border-box; display: flex; flex-direction: column; padding: 80px 60px; font-family: var(--sf); background-color: #121212; color: #fff; }
.sc-header { display: flex; align-items: center; margin-bottom: 40px; justify-content: center; }
.sc-title { font-size: 64px; font-weight: 800; letter-spacing: -2px; }

/* CONSOLA NO PRINT */
.sc-console-box {
    padding: 40px;
    box-shadow: 0 40px 80px rgba(0,0,0,0.6), inset 0 2px 0 rgba(255,255,255,0.1);
    border: 4px solid #000;
    margin-bottom: 40px;
    background-color: #2b2b2b;
    background-image: repeating-linear-gradient(45deg, rgba(0,0,0,0.05) 0px, rgba(0,0,0,0.05) 2px, transparent 2px, transparent 4px);
    border-radius: 30px;
    position: relative;
}
.sc-bezel { background: #111; border-radius: 20px; padding: 50px 30px; border: 6px solid #333; box-shadow: inset 0 0 30px #000; }
.sc-screen {
    height: 400px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'Silkscreen', cursive;
    position: relative;
    overflow: hidden;
    background-color: #8bac0f; 
    color: #0f380f;
    border-radius: 8px;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.3);
}
.sc-screen::after { content: " "; position: absolute; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%); background-size: 100% 6px; pointer-events: none; }
.sc-status-top {
    position: absolute; top: 25px; width: 100%; padding: 0 30px;
    display: flex; justify-content: space-between;
    font-size: 24px; letter-spacing: 1px; opacity: 0.8;
}
.sc-face-container { display: flex; flex-direction: column; align-items: center; }
.sc-face-icon { font-size: 140px; line-height: 1; margin-bottom: 20px; }
.sc-main-temp { font-size: 70px; font-weight: bold; letter-spacing: -2px; }
.sc-status-label { font-size: 20px; margin-top: 10px; opacity: 0.8; text-transform: uppercase; }

/* Dados em baixo */
.sc-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-bottom: 50px; }
.sc-item { background: rgba(255,255,255,0.05); padding: 30px; border-radius: 30px; display: flex; flex-direction: column; align-items: center; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
.sc-lbl { font-size: 22px; opacity: 0.6; font-weight: 700; text-transform: uppercase; margin-bottom: 5px; }
.sc-val { font-size: 40px; font-weight: 800; }
.sc-phrase-box { 
    margin-top: auto; margin-bottom: 30px;
    background: #000; color: #00ff41; 
    border: 6px solid #1a1a1a; border-radius: 40px; 
    padding: 30px; text-align: center; 
    font-family: var(--retro-font); font-size: 32px; line-height: 1.3; 
    word-break: break-word;
    text-transform: uppercase; 
    text-shadow: 0 0 20px rgba(0, 255, 65, 0.7); 
    box-shadow: 0 30px 60px rgba(0,0,0,0.5); 
    min-height: 200px; display: flex; align-items: center; justify-content: center;
}
.sc-footer { text-align: center; opacity: 0.4; font-size: 28px; font-weight: 600; }

.site-footer { margin-top: auto; padding-top: 20px; text-align: center; padding-bottom: 20px; }
.footer-credit { display: block; font-size: 12px; opacity: 0.5; color: var(--text-color); text-decoration: none; }
.footer-credit:hover { text-decoration: underline; }
.skeleton { animation: shimmer 1.5s infinite; opacity: 0.7; } @keyframes shimmer { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
</style>
</head>
<body>

<div class="city-modal-overlay" id="searchModalOverlay">
  <div class="city-modal">
    <h3>Selecionar Cidade</h3>
    <input type="text" class="modal-input" id="cityInput" placeholder="Digite o nome da cidade...">
    <button class="modal-btn-geo" onclick="useCurrentLocation()">
      <svg class="geo-icon" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7z"></path><circle cx="12" cy="9" r="2.5"></circle></svg>
      Usar Localização Atual
    </button>
    <div class="modal-results" id="searchResults"></div>
    <button class="modal-close" onclick="closeSearchModal()">Cancelar</button>
  </div>
</div>

<div id="shareCapture">
  <div class="sc-header"><div class="sc-title" id="printCityName">ORINDIÚVA</div></div>
  
  <div class="sc-console-box">
      <div class="screw tl" style="top:20px; left:20px; width:12px; height:12px;"></div>
      <div class="screw tr" style="top:20px; right:20px; width:12px; height:12px;"></div>
      <div class="screw bl" style="bottom:20px; left:20px; width:12px; height:12px;"></div>
      <div class="screw br" style="bottom:20px; right:20px; width:12px; height:12px;"></div>

      <div class="sc-bezel">
          <div class="sc-screen on">
              <div class="sc-status-top">
                  <span id="scTimeTop">--:--</span>
                  <span id="scDateTop">--/--</span>
              </div>
              <div class="sc-face-container">
                  <div class="sc-face-icon" id="scFaceIcon">(-.-)</div>
                  <div class="sc-main-temp" id="scMainTemp">--°C</div>
                  <div class="sc-status-label" id="scStatusLabel">MODO PET</div>
              </div>
          </div>
      </div>
  </div>

  <div class="sc-info-container">
    <div class="sc-grid">
      <div class="sc-item"><div class="sc-lbl">SENS. TÉRMICA</div><div class="sc-val" id="scFeelsLike">--°C</div></div>
      <div class="sc-item"><div class="sc-lbl">UMIDADE</div><div class="sc-val" id="scHumidity">--%</div></div>
      <div class="sc-item"><div class="sc-lbl">VENTO</div><div class="sc-val" id="scWind">-- km/h</div></div>
      <div class="sc-item"><div class="sc-lbl">LUA</div><div class="sc-val" id="scMoon">--</div></div>
       <div class="sc-item"><div class="sc-lbl">MÁX. HOJE</div><div class="sc-val" id="scMax">--°C</div></div>
      <div class="sc-item"><div class="sc-lbl">MÍN. HOJE</div><div class="sc-val" id="scMin">--°C</div></div>
      <div class="sc-item"><div class="sc-lbl">NASCER SOL</div><div class="sc-val" id="scSunrise">--:--</div></div>
      <div class="sc-item"><div class="sc-lbl">PÔR DO SOL</div><div class="sc-val" id="scSunset">--:--</div></div>
    </div>
  </div>
  <div class="sc-phrase-box" id="scPhrase">"..."</div>
  <div class="sc-footer">mateusfrmacedo.github.io/orindiuva</div>
</div>

<div class="site">
  <header class="header">
    <div class="title-box" onclick="openSearchModal()">
      <svg class="city-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
      <h1 id="headerCityName">Orindiúva</h1>
    </div>
    
    <div class="header-controls">
        <button id="settingsToggle" class="theme-toggle">
            <svg class="theme-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v2H6v-2H4v-2h2V9h2v2h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
        </button>
        <button id="themeToggle" class="theme-toggle">
          <svg id="moonIcon" class="theme-icon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
          <svg id="sunIcon" class="theme-icon" style="display:none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
        </button>
    </div>
  </header>
/* ATUALIZA AQUIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII */
  <section class="video-container" id="videoContainer">
    <iframe src="https://www.youtube.com/embed/_E2W0YDGG18?autoplay=1&mute=1&controls=1&rel=0&modestbranding=1&playsinline=1" title="Câmera ao vivo" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </section>

  <div class="dashboard-card">
    
    <div class="simple-display-panel" id="simpleDisplay">
      <div class="sim-left">
          <div class="sim-main-temp" id="simTemp">--°C</div>
          <div class="sim-max-min-box">
             <div class="sim-sub-val" id="simMaxMin">MÁX: --° / MÍN: --°</div>
          </div>
      </div>
    </div>

    <div class="retro-console" id="consoleArea">
      <div class="caution-stripe"></div>
      <div class="screw tl"></div><div class="screw tr"></div>
      <div class="screw bl"></div><div class="screw br"></div>

      <div class="gb-bezel">
        <div class="gb-screen on" id="gbScreen">
          
          <div class="status-left">
            <span class="retro-clock" id="retroClock">--:--:--</span>
            <span class="retro-date" id="retroDate">--/--/----</span>
          </div>

          <div class="status-bar">
            <svg class="status-icon anim-pulse" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
            <svg class="status-icon anim-wifi" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3a4.237 4.237 0 0 0-6 0zm-4-4l2 2a7.074 7.074 0 0 1 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
            <svg class="status-icon anim-charge" viewBox="0 0 24 24"><path d="M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4z"/></svg>
          </div>

          <div class="screen-mode active-mode" id="screenPet">
            <div class="pet-wrapper">
              <div class="pet-face" id="petFace">(-.-)</div>
              <div class="pet-text-area" id="petScreenText"></div>
              <div class="pet-zzz" id="petZzz">zZZ</div>
            </div>
          </div>

          <div class="screen-mode" id="screenWeather">
            <div class="weather-main">
               <div class="wm-icon" id="gbWeatherIcon"></div>
               <div class="wm-temp" id="gbTemp">--°C</div>
               <div class="wm-cond" id="gbCond">...</div>
               <div class="wm-city" id="wmCity">ORINDIÚVA</div>
            </div>
          </div>

        </div>
      </div>

      <div class="console-controls">
        <div class="power-group">
          <div class="power-led on" id="pwrLed"></div>
          <div class="power-btn active" id="pwrBtn" onclick="togglePower()">
            <div class="power-switch"></div>
          </div>
          <span class="label-text">POWER</span>
        </div>

        <div class="action-buttons">
          <div class="control-unit">
             <button class="analog-btn btn-red" id="tamaBtn"></button>
          </div>
          <div class="control-unit">
             <button class="analog-btn btn-blue" id="modeBtn"></button>
          </div>
        </div>

        <div class="speaker">
          <div class="speaker-hole"></div><div class="speaker-hole"></div><div class="speaker-hole"></div>
          <div class="speaker-hole"></div><div class="speaker-hole"></div><div class="speaker-hole"></div>
          <div class="speaker-hole"></div><div class="speaker-hole"></div><div class="speaker-hole"></div>
          <div class="speaker-hole"></div><div class="speaker-hole"></div><div class="speaker-hole"></div>
        </div>
      </div>
      
      <div class="console-ticker-area">
        <div class="ticker-bezel">
          <div class="ticker-screen" id="tickerScreen">
            <div class="ticker-wrap">
              <div class="ticker" id="newsTicker">
                <div class="ticker-item">INICIANDO SISTEMA...</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="modern-data-grid">
      <div class="detail-pill"><span class="detail-label">Vento</span><span class="detail-value skeleton" id="windSpeed">-- km/h</span></div>
      <div class="detail-pill"><span class="detail-label">Umidade</span><span class="detail-value skeleton" id="humidity">--%</span></div>
      <div class="detail-pill"><span class="detail-label">Sensação</span><span class="detail-value skeleton" id="feelsLike">--°C</span></div>
      <div class="detail-pill"><span class="detail-label">Fase da Lua</span><span class="detail-value skeleton" id="moonPhase">--</span></div>
      <div class="detail-pill"><span class="detail-label">Nascer Sol</span><span class="detail-value skeleton" id="sunriseTime">--:--</span></div>
      <div class="detail-pill"><span class="detail-label">Pôr do Sol</span><span class="detail-value skeleton" id="sunsetTime">--:--</span></div>
    </div>

    <div class="forecast-row" id="forecastBox">
      <div class="forecast-item skeleton">...</div><div class="forecast-item skeleton">...</div><div class="forecast-item skeleton">...</div><div class="forecast-item skeleton">...</div><div class="forecast-item skeleton">...</div>
    </div>
  </div>

  <footer class="site-footer">
    <a href="http://mateusfrmacedo.github.io" target="_blank" class="footer-credit">create by Mateus</a>
  </footer>
</div>
/* ATUALIZA AQUIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII */
<script>
const LIVE_ID = "_E2W0YDGG18";
const DEFAULT_CITY = { name: "Orindiúva", lat: -20.1819, lon: -49.3508 };

let currentCity = { ...DEFAULT_CITY };
let currentShareData = { 
    temp: "--", 
    cond: "", 
    max: "", 
    min: "", 
    wind: "", 
    moon: "", 
    weatherType: "clear", 
    phrase: "", 
    humidityRaw: 0, 
    windRaw: 0, 
    sunrise: "--", 
    sunset: "--", 
    feelsLike: "--" 
};
let weatherCode = 0;
let tempVal = 25;
let isPoweredOn = true;
let isWeatherMode = false;
let isConsoleVisible = false; // Controle de visibilidade do console

/* --- VARIÁVEIS GLOBAIS DE INFORMAÇÃO --- */
let infoCache = {
    finance: "",
    news: "",
    holiday: "",
    curiosity: ""
};

/* --- LISTA DE CURIOSIDADES/FATOS --- */
const CURIOSITIES = [
    "A FORMIGA LEVANTA 50X SEU PESO.",
    "O MEL NUNCA ESTRAGA.",
    "BICICLETAS NAO PARAM EM PE SOZINHAS.",
    "O BRASIL E O MAIOR PRODUTOR DE CAFE.",
    "GIRAFAS LIMPAM AS ORELHAS COM A LINGUA.",
    "O CORACAO DO CAMARAO FICA NA CABECA.",
    "VOCE PISCA CERCA DE 20 MIL VEZES POR DIA.",
    "O SOL E 330 MIL VEZES MAIOR QUE A TERRA.",
    "A LUA SE AFASTA 3CM DA TERRA POR ANO.",
    "GATOS NAO SENTEM GOSTO DOCE.",
    "GOLFINHOS DORMEM COM UM OLHO ABERTO.",
    "O OCEANO ATLANTICO E MAIS SALGADO QUE O PACIFICO.",
    "O DNA HUMANO E 50% IGUAL AO DA BANANA.",
    "URSOS POLARES SAO CANHOTOS.",
    "O CEREBRO NAO SENTE DOR.",
    "UM RAIO E 5X MAIS QUENTE QUE O SOL.",
    "TIGRES TEM PELE LISTRADA, NAO SO PELOS.",
    "O BRASIL TEM A MAIOR BIODIVERSIDADE DO MUNDO.",
    "A TORRE EIFFEL CRESCE NO VERAO.",
    "O MAIOR DESERTO DO MUNDO E A ANTARTICA."
];

/* --- GERENCIADOR DE INFORMAÇÕES (API HUB) --- */
const InfoManager = {
    // 1. FINANCEIRO (AwesomeAPI)
    async updateFinance() {
        try {
            const res = await fetch('https://economia.awesomeapi.com.br/last/USD-BRL,EUR-BRL,BTC-BRL');
            const data = await res.json();
            const usd = data.USDBRL;
            const eur = data.EURBRL;
            const btc = data.BTCBRL;
            infoCache.finance = `DINHEIRO QUE VOCE NAO TEM: USD ${usd.ask.substring(0,4)} | EUR ${eur.ask.substring(0,4)} | BTC ${btc.ask.split('.')[0]}`;
        } catch(e) { console.error("Erro Finance:", e); infoCache.finance = "SEM DADOS FINANCEIROS NO MOMENTO."; }
    },

    // 2. NOTÍCIAS (IBGE API)
    async updateNews() {
        try {
            const res = await fetch('https://servicodados.ibge.gov.br/api/v3/noticias/?tipo=release');
            const data = await res.json();
            if(data.items && data.items.length > 0) {
                const randomNews = data.items[Math.floor(Math.random() * 5)]; // Pega uma das 5 primeiras
                infoCache.news = `NOTICIA DO DIA: ${randomNews.titulo.toUpperCase()}`;
            } else {
                infoCache.news = "SEM NOTICIAS RELEVANTES HOJE.";
            }
        } catch(e) { console.error("Erro News:", e); infoCache.news = "ERRO AO BUSCAR NOTICIAS."; }
    },

    // 3. FERIADOS (BrasilAPI)
    async updateHolidays() {
        try {
            const year = new Date().getFullYear();
            const res = await fetch(`https://brasilapi.com.br/api/feriados/v1/${year}`);
            const data = await res.json();
            
            // Encontra o próximo feriado
            const today = new Date();
            const nextHoliday = data.find(h => new Date(h.date + "T00:00:00") >= today);
            
            if(nextHoliday) {
                const dateParts = nextHoliday.date.split('-');
                infoCache.holiday = `PROXIMO FERIADO: ${dateParts[2]}/${dateParts[1]} - ${nextHoliday.name.toUpperCase()}.`;
            } else {
                infoCache.holiday = "SEM FERIADOS POR ENQUANTO. TRABALHE.";
            }
        } catch(e) { console.error("Erro Holiday:", e); infoCache.holiday = "HOJE E DIA DE TRABALHO."; }
    },

    // 4. CURIOSIDADES (Local)
    updateCuriosity() {
        // Garantir que a curiosidade nunca repete a anterior
        const fact = CURIOSITIES[Math.floor(Math.random() * CURIOSITIES.length)];
        infoCache.curiosity = `CURIOSIDADE INUTIL: ${fact}`;
    },

    // INICIALIZADOR
    init() {
        this.updateFinance();
        this.updateNews();
        this.updateHolidays();
        this.updateCuriosity();
        
        // Atualiza a cada 10 minutos
        setInterval(() => {
            this.updateFinance();
            this.updateNews();
            this.updateCuriosity();
        }, 600000); 
    }
};

/* --- SISTEMA GRINCH SEPARADO (CLIMA) --- */
const GrinchSystem = {
    getSaudacao: function(h) {
        const manha = ["ACORDEM, HUMANOS.", "JA DE PE? QUE LASTIMA.", "BOM DIA... SE E QUE ISSO EXISTE.", "MAIS UM DIA SUPORTANDO VOCES.", "A LUZ DO SOL ME IRRITA."];
        const tarde = ["BOA TARDE.", "AINDA ESTAO AI?", "O SOL ESTA NO MEU OLHO.", "TARDE INUTIL.", "QUERIA ESTAR NA MINHA CAVERNA."];
        const noite = ["BOA NOITE.", "VAO DORMIR LOGO.", "FINALMENTE ESCURO.", "A LUA ESTA ME JULGANDO.", "SILENCIO, POR FAVOR."];
        if (h < 12) return manha[Math.floor(Math.random() * manha.length)];
        if (h < 18) return tarde[Math.floor(Math.random() * tarde.length)];
        return noite[Math.floor(Math.random() * noite.length)];
    },
    getIntroCidade: function(city) {
        const frases = [`AQUI NESSE BURACO CHAMADO ${city.toUpperCase()}...`, `OLHANDO AQUI PRA ${city.toUpperCase()}...`, `NA POBRE ${city.toUpperCase()} AGORA...`, `SOBREVOANDO ${city.toUpperCase()}...`];
        return frases[Math.floor(Math.random() * frases.length)];
    },
    getTempPhrase: function(temp) {
        return `ESTA FAZENDO ${temp} GRAUS.`;
    },
    getComentarioClima: function(temp, code, wind) {
        if (temp >= 33) return ["LIGUEI O FORNO NO MAXIMO.", "VOCES VAO VIRAR TORRESMO.", "ADORO VER VOCES SUANDO."][Math.floor(Math.random()*3)];
        if (temp >= 28) return ["ESTA QUENTE, CULPA MINHA.", "AUMENTEI O AQUECIMENTO GLOBAL.", "SUEM, HUMANOS, SUEM."][Math.floor(Math.random()*3)];
        if (temp <= 15) return ["CONGELEI SEUS NARIZES.", "LIGUEI O AR CONDICIONADO DO CEU.", "TREMAM DE FRIO."][Math.floor(Math.random()*3)];
        if (code >= 95) return ["VOU MANDAR RAIOS NA CABECA DE ALGUEM.", "DESLIGUEM O WIFI, VAI DAR CURTO."][Math.floor(Math.random()*2)];
        if (code >= 50) return ["APERTEI A DESCARGA DO CEU.", "MOLHANDO TUDO DE PROPOSITO."][Math.floor(Math.random()*2)];
        if (wind > 20) return ["SOPRANDO SUAS ESPERANCAS LONGE.", "VOU DERRUBAR UMA ARVORE."][Math.floor(Math.random()*2)];
        return ["CLIMA CHATO, IGUAL A VOCES.", "NADA ACONTECENDO, QUE TEDIO."][Math.floor(Math.random()*2)];
    },
    getDadosTecnicos: function(max, min) {
        return `HOJE VAI DE ${min} ATE ${max} GRAUS.`;
    },
    getSensacao: function(feels, temp) {
        if (feels > temp) return `MAS PARECE QUE ESTA ${feels} GRAUS. INFERNAL.`;
        if (feels < temp) return `COM SENSACAO DE ${feels} GRAUS. GELADO.`;
        return `A SENSACAO E A MESMA. SEM GRACA.`;
    },
    getDespedida: function() {
        const frases = ["NAO ME IRRITEM OU FACO CHOVER CANIVETE.", "EU CONTROLO O CEU, RESPEITEM.", "AGORA SAIAM DA MINHA TELA.", "VOU VOLTAR A DORMIR."];
        return frases[Math.floor(Math.random() * frases.length)];
    },
    gerarFraseCompleta: function(data, cityName, hour) {
        const part1 = this.getSaudacao(hour);
        const part2 = this.getIntroCidade(cityName);
        const part3 = this.getTempPhrase(data.temp.replace('°C',''));
        const part4 = this.getComentarioClima(parseFloat(data.temp), weatherCode, data.windRaw);
        const part5 = this.getDadosTecnicos(data.max.replace('°C',''), data.min.replace('°C',''));
        const part6 = this.getSensacao(parseFloat(data.feelsLike), parseFloat(data.temp));
        const part7 = this.getDespedida();
        // ALTERAÇÃO DE ORDEM AQUI: SAUDAÇÃO -> GRINCH -> RESTO
        const fullPhrase = `${part1} *** ${part4} *** ${part2} ${part3} *** ${part5} *** ${part6} *** ${part7}`;
        return { text: fullPhrase, shortPhrase: part4 }; 
    }
};

/* --- FRASES E EXPRESSÕES DO PET (SEM EMOJIS, APENAS KAOMOJI) --- */
let lastRandomIndex = -1;
function getUniqueRandomPair(arr) {
    let index;
    do {
        index = Math.floor(Math.random() * arr.length);
    } while (index === lastRandomIndex && arr.length > 1);
    lastRandomIndex = index;
    return arr[index];
}

const INTERACTION_PAIRS = {
    random: [
        {t: "ESTOU COM FOME", f: "(o o)"}, {t: "ESTOU ENTEDIADO", f: "(-_-)"}, {t: "VOCE E FEIO", f: "(¬_¬)"},
        {t: "QUE VONTADE DE SUMIR", f: "(._.)"}, {t: "JA TOMOU AGUA HOJE?", f: "(?_?)"}, {t: "ESTOU OCUPADO", f: "(>_<)"},
        {t: "SOU O REI DO MUNDO", f: "(^o^)"}, {t: "QUERO COMER CHOCOLATE", f: "(^3^)"}, {t: "PODIA CHOVER", f: "(T_T)"},
        {t: "ME SEGUE NO INSTAGRAM", f: "(^_^)"}, {t: "CURTE MEU VIDEO NO TIKTOK", f: "(>o<)"}, {t: "VAMOS JOGAR?", f: "(^o^)/"},
        {t: "VOU ASSISTIR NETFLIX", f: "(o_O)"}, {t: "TO OUVINDO SPOTIFY", f: "(~_~)"}, {t: "ODEIO MEU TRABALHO", f: "(x_x)"},
        {t: "VOU TOMAR BANHO", f: "(>3<)"}, {t: "QUERIA COMER PIZZA", f: "(Q_Q)"}, {t: "TO COM PENSAMENTOS ERRADOS", f: "(¬_¬)"},
        {t: "VOU JOGAR", f: "(^.^)"}, {t: "MEU IPHONE TRINCOU", f: "(;_;)"}, {t: "JURO MIGA", f: "(O_O)"},
        {t: "AFF", f: "(¬_¬)"}, {t: "QUE TEDIO", f: "(=_=)"}, {t: "TEMPO BOM PRA DORMIR", f: "(-.-)"}
    ],
    angry: [
        {t: "NAO ME IRRITE!", f: "(O_O)"}, {t: "PARE COM ISSO!", f: "(>_<)"}, {t: "VOU DESLIGAR O SOL!", f: "(#_#)"},
        {t: "QUER UM RAIO?!", f: "(o_o)"}, {t: "SAI DAQUI!", f: "(>o<)"}
    ]
};

const TAMA_FACES = {
  happy: ['(^.^)', '(^o^)', '(^_^)', '(*_*)'], 
  angry: ['(O_O)', '(¬_¬)', '(-_-)', '(#_#)'], 
  sleepy: ['(-.-)', '(u_u)', '(~.~)'], 
  confused: ['(o_O)', '(?_?)', '(>_<)'], 
  eating: ['(o o)', '( -.-)', '(o O)'], 
  cool: ['(u_u)', '(-.-)'], 
  sad: ['(T_T)', '(._.)', '(;_;)'], 
  hot: ['(;´Д`)', '(~_~;)', '(=_=)'], 
  cold: ['(>_<)', '(#.#)', '(~.~)'], 
  crazy: ['(@_@)', '(x_x)', '(o_O)']
};

/* --- ICONS SVG --- */
const PIXEL_SVGS = {
  clear: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M7 0h2v2H7zM7 14h2v2H7zM0 7h2v2H0zM14 7h2v2h-2zM2 2h2v2H2zM12 12h2v2h-2zM2 12h2v2H2zM12 2h2v2h-2zM5 5h6v6H5z"/></svg>',
  cloudy: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 6h8v2h2v4H2V8h2V6z"/></svg>',
  rain: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 4h8v2h2v4H2V6h2V4zM4 12h2v2H4zM8 12h2v2H8zM12 12h2v2h-2z"/></svg>',
  storm: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 4h8v2h2v4H2V6h2V4zM7 11h3l-2 5h2l-4-5z"/></svg>'
};
const CLEAN_SVGS = {
  clear: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>',
  cloudy: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/></svg>',
  rain: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 13v5M8 13v5M12 15v5M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"/></svg>',
  storm: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>'
};

/* ORINDI-PET LOGIC */
let tamaState = 'happy'; 
let pokeCount = 0; 
let lastInteraction = Date.now();
let textTimer = null;
let angerTimer = null;
let currentFaceOverride = null;

function showReaction(type) {
    const screenText = document.getElementById('petScreenText');
    const faceEl = document.getElementById('petFace');
    
    let pair;
    if (type === 'angry') {
        pair = INTERACTION_PAIRS.angry[Math.floor(Math.random() * INTERACTION_PAIRS.angry.length)];
        tamaState = 'angry';
    } else {
        // Usa função anti-repetição
        pair = getUniqueRandomPair(INTERACTION_PAIRS.random);
        tamaState = 'talking'; 
    }

    screenText.innerText = pair.t;
    screenText.classList.add('visible');
    
    faceEl.innerText = pair.f;
    currentFaceOverride = pair.f;

    if(textTimer) clearTimeout(textTimer);
    textTimer = setTimeout(() => {
        screenText.classList.remove('visible');
        currentFaceOverride = null; 
        if(type !== 'angry') tamaState = 'happy'; 
    }, 4000);
}

function updateTamagotchi() {
  if (!isPoweredOn) return;
  
  const faceEl = document.getElementById('petFace');
  const zzzEl = document.getElementById('petZzz');
  const screenText = document.getElementById('petScreenText');
  
  // Limpa classes de animação anteriores
  faceEl.classList.remove('anim-angry', 'anim-bounce', 'anim-shiver', 'anim-melt');

  if (currentFaceOverride) {
      faceEl.innerText = currentFaceOverride;
      if(tamaState === 'angry') faceEl.classList.add('anim-angry');
      else faceEl.classList.add('anim-bounce');
      zzzEl.style.display = 'none';
      return; 
  }

  const timeSinceInteract = Date.now() - lastInteraction;
  
  if (timeSinceInteract > 10000) {
      tamaState = 'sleepy';
      screenText.classList.remove('visible'); 
  } else if (tempVal > 28) {
      tamaState = 'hot';
  } else if (tempVal < 20) {
      tamaState = 'cold';
  } else {
      const rand = Math.random();
      if(rand < 0.33) tamaState = 'happy';
      else if(rand < 0.66) tamaState = 'cool';
      else tamaState = 'crazy';
  }

  zzzEl.style.display = tamaState === 'sleepy' ? 'block' : 'none';
  
  if (tamaState === 'sleepy') {
      faceEl.innerText = '(-.-)';
  } else {
      const list = TAMA_FACES[tamaState] || TAMA_FACES.happy;
      faceEl.innerText = list[Math.floor(Math.random()*list.length)];
  }
  
  if(tamaState === 'happy' || tamaState === 'cool' || tamaState === 'crazy') faceEl.classList.add('anim-bounce');
  if(tamaState === 'cold') faceEl.classList.add('anim-shiver');
  if(tamaState === 'hot') faceEl.classList.add('anim-melt');
  
  let svg = PIXEL_SVGS.clear;
  if(currentShareData.weatherType === 'cloudy') svg = PIXEL_SVGS.cloudy;
  if(currentShareData.weatherType === 'rain') svg = PIXEL_SVGS.rain;
  if(currentShareData.weatherType === 'storm') svg = PIXEL_SVGS.storm;
  
  document.getElementById('gbWeatherIcon').innerHTML = svg;
}

// Power Toggle
function togglePower() {
  isPoweredOn = !isPoweredOn;
  const screen = document.getElementById('gbScreen');
  const led = document.getElementById('pwrLed');
  const btn = document.getElementById('pwrBtn');
  const leftStatus = document.querySelector('.status-left');
  const rightStatus = document.querySelector('.status-bar');
  const tickerScreen = document.getElementById('tickerScreen');

  if (isPoweredOn) {
    screen.classList.remove('off-anim');
    screen.classList.add('on-anim');
    setTimeout(() => screen.classList.remove('on-anim'), 400); 
    screen.classList.add('on');
    led.className = 'power-led on';
    btn.className = 'power-btn active';
    if(leftStatus) leftStatus.style.display = 'flex';
    if(rightStatus) rightStatus.style.display = 'flex';
    if(tickerScreen) tickerScreen.classList.remove('off');
    lastInteraction = Date.now(); 
    runTickerCycle(); 
    updateTamagotchi();
  } else {
    screen.classList.remove('on');
    screen.classList.add('off-anim'); 
    led.className = 'power-led off';
    btn.className = 'power-btn';
    if(leftStatus) leftStatus.style.display = 'none';
    if(rightStatus) rightStatus.style.display = 'none';
    if(tickerScreen) tickerScreen.classList.add('off');
  }
}

document.getElementById('modeBtn').onclick = () => {
  if(!isPoweredOn) return;
  lastInteraction = Date.now(); 
  isWeatherMode = !isWeatherMode;
  document.getElementById('screenPet').className = isWeatherMode ? 'screen-mode' : 'screen-mode active-mode';
  document.getElementById('screenWeather').className = isWeatherMode ? 'screen-mode active-mode' : 'screen-mode';
};

document.getElementById('tamaBtn').onclick = () => {
  if(!isPoweredOn || isWeatherMode) {
    isWeatherMode = false;
    document.getElementById('screenPet').className = 'screen-mode active-mode';
    document.getElementById('screenWeather').className = 'screen-mode';
    return;
  }
  
  lastInteraction = Date.now(); 
  pokeCount++; 
  
  if (pokeCount > 5) {
      showReaction('angry');
      if(angerTimer) clearTimeout(angerTimer);
      angerTimer = setTimeout(() => {
          pokeCount = 0;
          currentFaceOverride = null;
          updateTamagotchi();
      }, 5000);
  } else {
      showReaction('random');
  }
};

/* RELÓGIO */
function updateRetroClock() {
  const now = new Date();
  const day = String(now.getDate()).padStart(2, '0');
  const month = String(now.getMonth() + 1).padStart(2, '0');
  const year = now.getFullYear();
  const h = String(now.getHours()).padStart(2, '0');
  const m = String(now.getMinutes()).padStart(2, '0');
  const s = String(now.getSeconds()).padStart(2, '0');

  const dateEl = document.getElementById('retroDate');
  const clockEl = document.getElementById('retroClock');

  if(dateEl) dateEl.innerText = `${day}/${month}/${year}`;
  if(clockEl) clockEl.innerText = `${h}:${m}:${s}`;
  
  // Atualiza também os relógios do Print
  const scTime = document.getElementById('scTimeTop');
  const scDate = document.getElementById('scDateTop');
  if(scTime) scTime.innerText = `${h}:${m}`;
  if(scDate) scDate.innerText = `${day}/${month}`;
}
setInterval(updateRetroClock, 1000);
updateRetroClock();

/* TICKER COM ROTAÇÃO DE CANAIS (CLIMA, FINANCEIRO, NEWS, CURIOSIDADES) */
let tickerChannel = 0; // 0: Clima, 1: Financeiro, 2: News, 3: Feriado/Curiosidade

function runTickerCycle() {
  const tickerEl = document.getElementById('newsTicker');
  if(!tickerEl || !isPoweredOn) return;
  
  let displayText = "";
  
  // Lógica de Rotação
  if (tickerChannel === 0) {
      // CANAL 0: CLIMA (Grinch)
      const generated = GrinchSystem.gerarFraseCompleta(currentShareData, currentCity.name, new Date().getHours());
      displayText = generated.text;
      currentShareData.phrase = generated.shortPhrase; // Atualiza para o print
  } 
  else if (tickerChannel === 1) {
      // CANAL 1: FINANCEIRO
      displayText = infoCache.finance || "ATUALIZANDO DADOS FINANCEIROS...";
  }
  else if (tickerChannel === 2) {
      // CANAL 2: NOTÍCIAS
      displayText = infoCache.news || "SEM NOTICIAS NO MOMENTO.";
  }
  else {
      // CANAL 3: MISTO (Feriado ou Curiosidade)
      if(Math.random() > 0.5) displayText = infoCache.holiday;
      else displayText = infoCache.curiosity;
  }

  // Avança para o próximo canal
  tickerChannel++;
  if(tickerChannel > 3) tickerChannel = 0;

  // Renderiza
  tickerEl.innerHTML = `<span class="ticker-item">${displayText}</span>`;
  tickerEl.style.animation = 'none'; 
  tickerEl.offsetHeight; 
  
  // Velocidade ajustada baseada no tamanho do texto
  const speed = Math.max(15, displayText.length * 0.18);
  tickerEl.style.animation = `ticker-scroll ${speed}s linear infinite`;
}

// IMPORTANTE: Remove listeners antigos para evitar conflitos e adiciona novo
const tickerElement = document.getElementById('newsTicker');
if(tickerElement) {
    const newTicker = tickerElement.cloneNode(true);
    tickerElement.parentNode.replaceChild(newTicker, tickerElement);
    newTicker.addEventListener('animationiteration', runTickerCycle);
}

/* SETTINGS TOGGLE (ALTERNAR MODO SIMPLES/GAMEBOY) */
const settingsBtn = document.getElementById('settingsToggle');
const consoleArea = document.getElementById('consoleArea');
const simpleDisplay = document.getElementById('simpleDisplay');

settingsBtn.onclick = () => {
    isConsoleVisible = !isConsoleVisible;
    if (isConsoleVisible) {
        consoleArea.classList.add('active');
        simpleDisplay.style.display = 'none';
    } else {
        consoleArea.classList.remove('active');
        simpleDisplay.style.display = 'flex';
    }
};

/* CIDADE & GEO */
function openSearchModal() { document.getElementById('searchModalOverlay').classList.add('active'); document.getElementById('cityInput').focus(); }
function closeSearchModal() { document.getElementById('searchModalOverlay').classList.remove('active'); }

let searchTimeout;
document.getElementById('cityInput').addEventListener('input', (e) => {
  clearTimeout(searchTimeout);
  const q = e.target.value;
  if(q.length < 3) return;
  searchTimeout = setTimeout(async () => {
    try {
      const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${q}&count=5&language=pt&format=json`);
      const data = await res.json();
      const list = document.getElementById('searchResults');
      list.innerHTML = '';
      if(data.results) {
        data.results.forEach(city => {
          const item = document.createElement('div');
          item.className = 'search-item';
          item.innerText = `${city.name}, ${city.admin1 || ''} - ${city.country_code}`;
          item.onclick = () => selectCity(city.name, city.latitude, city.longitude);
          list.appendChild(item);
        });
      }
    } catch(e) { console.error(e); }
  }, 500);
});

async function useCurrentLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(async (pos) => {
      selectCity("Localização Atual", pos.coords.latitude, pos.coords.longitude);
    }, () => alert("Erro ao obter localização."));
  } else { alert("Geolocalização não suportada."); }
}

function selectCity(name, lat, lon) {
  currentCity = { name, lat, lon };
  document.getElementById('headerCityName').innerText = name;
  document.getElementById('printCityName').innerText = name.toUpperCase();
  document.getElementById('wmCity').innerText = name.toUpperCase();
  closeSearchModal();

  const videoContainer = document.getElementById('videoContainer');
  const normalizedName = name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  
  if (normalizedName.includes("orindiuva") || name === "Localização Atual") {
    videoContainer.classList.remove('hidden');
    videoContainer.style.display = "block";
  } else {
    videoContainer.classList.add('hidden');
    videoContainer.style.display = "none";
  }
  fetchAllData();
}

/* DATA API */
async function fetchAllData() {
  try {
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${currentCity.lat}&longitude=${currentCity.lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,is_day,precipitation,weather_code,wind_speed_10m&daily=temperature_2m_max,temperature_2m_min,sunrise,sunset,weather_code&timezone=auto`;
    const wRes = await fetch(url);
    const wData = await wRes.json();
    
    const curr = wData.current;
    const daily = wData.daily;
    
    tempVal = Math.round(curr.temperature_2m);
    weatherCode = curr.weather_code;
    
    let cond = "Nublado"; let type = 'cloudy';
    if(weatherCode===0) { cond="Limpo"; type='clear'; }
    else if([1,2,3].includes(weatherCode)) { cond="Nublado"; type='cloudy'; }
    else if([51,53,55,61,63,65,80,81,82].includes(weatherCode)) { cond="Chuva"; type='rain'; }
    else if([95,96,99].includes(weatherCode)) { cond="Tempestade"; type='storm'; }
    
    currentShareData = {
      temp: tempVal + "°C", cond: cond,
      max: Math.round(daily.temperature_2m_max[0]) + "°C",
      min: Math.round(daily.temperature_2m_min[0]) + "°C",
      wind: Math.round(curr.wind_speed_10m) + " km/h",
      weatherType: type,
      humidityRaw: curr.relative_humidity_2m,
      windRaw: curr.wind_speed_10m,
      sunrise: daily.sunrise[0].split('T')[1],
      sunset: daily.sunset[0].split('T')[1],
      feelsLike: Math.round(curr.apparent_temperature) + "°C",
      phrase: "" 
    };

    // Console Update
    document.getElementById('gbTemp').innerText = currentShareData.temp;
    document.getElementById('gbCond').innerText = cond;

    // Simple Display Update
    document.getElementById('simTemp').innerText = currentShareData.temp;
    document.getElementById('simMaxMin').innerText = `MÁX: ${currentShareData.max.replace('C','')} / MÍN: ${currentShareData.min.replace('C','')}`;
    
    // Details
    document.getElementById('windSpeed').innerText = currentShareData.wind;
    document.getElementById('humidity').innerText = curr.relative_humidity_2m + "%";
    document.getElementById('feelsLike').innerText = currentShareData.feelsLike;
    
    document.getElementById('sunriseTime').innerText = daily.sunrise[0].split('T')[1];
    document.getElementById('sunsetTime').innerText = daily.sunset[0].split('T')[1];
    
    const moon = getMoonPhase(new Date());
    document.getElementById('moonPhase').innerText = moon.t;
    currentShareData.moon = moon.t;

    document.querySelectorAll('.skeleton').forEach(el => el.classList.remove('skeleton'));
    
    if (tickerChannel === 0) runTickerCycle();
    
    const box = document.getElementById('forecastBox');
    box.innerHTML = '';
    for(let i=1; i<=5; i++){
      const dName = new Date(daily.time[i]+'T00:00').toLocaleDateString('pt-BR',{weekday:'short'}).replace('.','');
      const wCode = daily.weather_code[i];
      let svgIcon = CLEAN_SVGS.cloudy;
      if (wCode === 0) svgIcon = CLEAN_SVGS.clear;
      else if (wCode >= 51) svgIcon = CLEAN_SVGS.rain;
      else if (wCode >= 95) svgIcon = CLEAN_SVGS.storm;

      box.innerHTML += `<div class="forecast-item">
        <div class="f-day">${dName}</div>
        <div class="f-icon">${svgIcon}</div>
        <div><span class="f-temp">${Math.round(daily.temperature_2m_max[i])}°</span> <span class="f-min">${Math.round(daily.temperature_2m_min[i])}°</span></div>
      </div>`;
    }
    updateTamagotchi();
  } catch(e) { console.log("Erro API:", e); }
}

const themeBtn = document.getElementById('themeToggle');
let currentTheme = localStorage.getItem('theme') || 'light';
function updateThemeUI(t){ if(t==='dark'){document.body.classList.add('dark');document.getElementById('sunIcon').style.display='block';document.getElementById('moonIcon').style.display='none';}else{document.body.classList.remove('dark');document.getElementById('sunIcon').style.display='none';document.getElementById('moonIcon').style.display='block';} }
updateThemeUI(currentTheme);
themeBtn.onclick = () => { currentTheme = currentTheme === 'dark' ? 'light' : 'dark'; updateThemeUI(currentTheme); localStorage.setItem('theme', currentTheme); };

function getMoonPhase(date) {
  const diff = (date.getTime() - new Date('2000-01-06T18:14:00Z').getTime()) / 86400000;
  const idx = (diff % 29.5305882) / 29.5305882;
  if(idx < 0.03) return {icon:'🌑', t:'Nova'}; if(idx < 0.22) return {icon:'🌒', t:'Crescente'}; if(idx < 0.28) return {icon:'🌓', t:'Q. Cresc.'}; if(idx < 0.47) return {icon:'🌔', t:'Gibosa'};
  if(idx < 0.53) return {icon:'🌕', t:'Cheia'}; if(idx < 0.72) return {icon:'🌖', t:'Gibosa'}; if(idx < 0.78) return {icon:'🌗', t:'Q. Ming.'}; if(idx < 0.97) return {icon:'🌘', t:'Minguante'};
  return {icon:'🌑', t:'Nova'};
}

// INICIALIZA TUDO
InfoManager.init();
fetchAllData(); 
setInterval(fetchAllData, 300000);
</script>
</body>
</html>
